

$(function() {
  $("#patient-department-id").on("change", function() {
    $("#head-doctor").val($(this).find("option:selected").data("doctor"));
    $("#head-doctor").closest(".label-floating").removeClass("is-empty");
  });

  $("#register-department").on("click", function() {
    var url = "<%= admin_ajax_departments_path %>";
    $.get(url, null, null, "script");
  });

  $("#patient_photos").on("change", function() {
    if (!this.files[0]) {
      $("#find-count").addClass('hidden');
      return;
    }

    var images = [];
    for (var i = 0; i < this.files.length; i++) {

      var figure = document.createElement("figure");
      figure.classList.add("patient-img-prev");
      figure.setAttribute("title", this.files[i].name);

      var caption = document.createElement("figcaption");
      caption.innerHTML = this.files[i].name;

      var img = document.createElement("img");
      img.src = URL.createObjectURL(this.files[i]);

      $(figure).html([img, caption]);

      images.push(figure);
    }

    $("#photos-preview").html(images);
    $("#file-count-text").text("Đã chọn " + this.files.length + " ảnh.");
    $("#find-count").removeClass("hidden");
  });

  $("#clear-input").on("click", function() {
    $("#photos-preview").html("");
    $("#patient_photos").val(null);
    $("#file-count-text").text("Đã chọn 0 ảnh");
    $("#find-count").addClass("hidden");
  });
});
